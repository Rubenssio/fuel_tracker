{% extends "base.html" %}
{% load static %}
{% block content %}
<div class="card mt-6">
    <div class="card-body">
        <h1 class="page-title">Metrics</h1>
        <form method="get" class="form-row gap-4">
            <fieldset class="form-row cols-2 gap-4">
                <legend class="muted">View options</legend>
                <div>
                    <label for="metrics-vehicle">Vehicle</label>
                    <select id="metrics-vehicle" name="vehicle">
                        <option value="all" {% if selected_vehicle == "all" %}selected{% endif %}>All vehicles</option>
                        {% for vehicle in vehicles %}
                            <option value="{{ vehicle.id }}" {% if selected_vehicle == vehicle.id|stringformat:"s" %}selected{% endif %}>{{ vehicle.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div>
                    <label for="metrics-window">Window</label>
                    <select id="metrics-window" name="window">
                        <option value="30" {% if window == "30" %}selected{% endif %}>Last 30 days</option>
                        <option value="90" {% if window == "90" %}selected{% endif %}>Last 90 days</option>
                        <option value="ytd" {% if window == "ytd" %}selected{% endif %}>Year to date</option>
                    </select>
                </div>
                <div class="form-row gap-4">
                    <button type="submit" class="btn btn-primary">Apply</button>
                </div>
            </fieldset>
        </form>

        <section class="mt-6">
            <h2>Rolling ({{ window_label }})</h2>
            <ul>
                <li>Avg cost per {{ unit_prefs.volume }}: {{ rolling_metrics.avg_cost_per_volume|default:"—" }}</li>
                <li>Avg consumption ({{ efficiency_label }}): {{ rolling_metrics.avg_consumption|default:"—" }}</li>
                <li>Avg distance/day: {{ rolling_metrics.avg_distance_per_day|default:"—" }}</li>
                <li>Avg cost/{{ unit_prefs.distance }}: {{ rolling_metrics.avg_cost_per_distance|default:"—" }}</li>
                <li>Total spend: {{ rolling_metrics.total_spend|default:"—" }}</li>
                <li>Total distance: {{ rolling_metrics.total_distance|default:"—" }}</li>
            </ul>
        </section>

        <section class="mt-6">
            <h2>All-time</h2>
            <ul>
                <li>Avg cost per {{ unit_prefs.volume }}: {{ all_time_metrics.avg_cost_per_volume|default:"—" }}</li>
                <li>Avg consumption ({{ efficiency_label }}): {{ all_time_metrics.avg_consumption|default:"—" }}</li>
                <li>Avg distance/day: {{ all_time_metrics.avg_distance_per_day|default:"—" }}</li>
                <li>Avg cost/{{ unit_prefs.distance }}: {{ all_time_metrics.avg_cost_per_distance|default:"—" }}</li>
                <li>Total spend: {{ all_time_metrics.total_spend|default:"—" }}</li>
                <li>Total distance: {{ all_time_metrics.total_distance|default:"—" }}</li>
            </ul>
        </section>
    </div>
</div>
{% endblock %}
